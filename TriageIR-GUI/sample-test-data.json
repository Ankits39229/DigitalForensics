{
  "scan_metadata": {
    "scan_id": "test-12345-67890-abcdef",
    "scan_start_utc": "2024-12-08T15:30:45Z",
    "scan_duration_ms": 2847,
    "hostname": "TEST-WORKSTATION",
    "os_version": "Windows 11 Pro 22H2 (Build 22621)",
    "cli_version": "TriageIR-CLI v1.0.0"
  },
  "artifacts": {
    "system_info": {
      "uptime_secs": 86400,
      "logged_on_users": [
        {
          "username": "administrator",
          "domain": "TEST-DOMAIN",
          "logon_time": "2024-12-08T08:00:00Z",
          "session_id": 1
        },
        {
          "username": "analyst",
          "domain": "LOCAL",
          "logon_time": "2024-12-08T09:15:30Z",
          "session_id": 2
        }
      ]
    },
    "running_processes": [
      {
        "pid": 4,
        "parent_pid": 0,
        "name": "System",
        "command_line": "",
        "executable_path": "",
        "user": "NT AUTHORITY\\SYSTEM",
        "memory_mb": 0.5,
        "sha256_hash": "N/A"
      },
      {
        "pid": 1234,
        "parent_pid": 4,
        "name": "explorer.exe",
        "command_line": "C:\\Windows\\Explorer.exe",
        "executable_path": "C:\\Windows\\explorer.exe",
        "user": "TEST-DOMAIN\\administrator",
        "memory_mb": 45.2,
        "sha256_hash": "a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456"
      },
      {
        "pid": 5678,
        "parent_pid": 1234,
        "name": "notepad.exe",
        "command_line": "C:\\Windows\\System32\\notepad.exe C:\\temp\\notes.txt",
        "executable_path": "C:\\Windows\\System32\\notepad.exe",
        "user": "TEST-DOMAIN\\administrator",
        "memory_mb": 12.8,
        "sha256_hash": "b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef1234567"
      },
      {
        "pid": 9999,
        "parent_pid": 1234,
        "name": "suspicious.exe",
        "command_line": "C:\\temp\\suspicious.exe -hidden -connect 192.168.1.100",
        "executable_path": "C:\\temp\\suspicious.exe",
        "user": "TEST-DOMAIN\\administrator",
        "memory_mb": 25.6,
        "sha256_hash": "deadbeefcafebabe1234567890abcdef1234567890abcdef1234567890abcdef"
      }
    ],
    "network_connections": [
      {
        "protocol": "TCP",
        "local_address": "192.168.1.50:443",
        "remote_address": "8.8.8.8:53",
        "state": "ESTABLISHED",
        "owning_pid": 1234
      },
      {
        "protocol": "TCP",
        "local_address": "192.168.1.50:80",
        "remote_address": "0.0.0.0:0",
        "state": "LISTENING",
        "owning_pid": 4
      },
      {
        "protocol": "UDP",
        "local_address": "192.168.1.50:53",
        "remote_address": "0.0.0.0:0",
        "state": "LISTENING",
        "owning_pid": 1234
      },
      {
        "protocol": "TCP",
        "local_address": "192.168.1.50:4444",
        "remote_address": "192.168.1.100:80",
        "state": "ESTABLISHED",
        "owning_pid": 9999
      }
    ],
    "persistence_mechanisms": [
      {
        "type": "Registry Run Key",
        "name": "Windows Security Update",
        "source": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
        "command": "C:\\Windows\\System32\\svchost.exe -k netsvcs",
        "suspicious": false
      },
      {
        "type": "Registry Run Key",
        "name": "SystemUpdate",
        "source": "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
        "command": "C:\\temp\\suspicious.exe -startup",
        "suspicious": true
      },
      {
        "type": "Scheduled Task",
        "name": "Microsoft\\Windows\\UpdateOrchestrator\\Schedule Scan",
        "source": "Task Scheduler",
        "command": "C:\\Windows\\System32\\UsoClient.exe ScanInstallWait",
        "suspicious": false
      },
      {
        "type": "Scheduled Task",
        "name": "SystemMaintenance",
        "source": "Task Scheduler",
        "command": "C:\\temp\\suspicious.exe -task",
        "suspicious": true
      }
    ],
    "event_logs": {
      "security": [
        {
          "event_id": 4624,
          "level": "Information",
          "source": "Microsoft-Windows-Security-Auditing",
          "timestamp": "2024-12-08T15:25:30Z",
          "message": "An account was successfully logged on. Subject: Security ID: S-1-5-21-123456789-987654321-111111111-1001 Account Name: administrator Account Domain: TEST-DOMAIN"
        },
        {
          "event_id": 4625,
          "level": "Warning",
          "source": "Microsoft-Windows-Security-Auditing",
          "timestamp": "2024-12-08T15:20:15Z",
          "message": "An account failed to log on. Subject: Security ID: S-1-0-0 Account Name: - Account Domain: - Failure Information: Failure Reason: Unknown user name or bad password."
        },
        {
          "event_id": 4648,
          "level": "Information",
          "source": "Microsoft-Windows-Security-Auditing",
          "timestamp": "2024-12-08T15:28:45Z",
          "message": "A logon was attempted using explicit credentials. Subject: Security ID: S-1-5-21-123456789-987654321-111111111-1001 Account Name: administrator"
        }
      ],
      "system": [
        {
          "event_id": 7045,
          "level": "Information",
          "source": "Service Control Manager",
          "timestamp": "2024-12-08T15:22:10Z",
          "message": "A service was installed in the system. Service Name: SuspiciousService Service File Name: C:\\temp\\suspicious.exe Service Type: user mode service"
        },
        {
          "event_id": 1074,
          "level": "Information",
          "source": "User32",
          "timestamp": "2024-12-08T14:30:00Z",
          "message": "The process C:\\Windows\\system32\\winlogon.exe (TEST-WORKSTATION) has initiated the restart of computer TEST-WORKSTATION on behalf of user TEST-DOMAIN\\administrator"
        },
        {
          "event_id": 6005,
          "level": "Information",
          "source": "EventLog",
          "timestamp": "2024-12-08T08:00:00Z",
          "message": "The Event log service was started."
        }
      ]
    }
  },
  "collection_log": [
    {
      "timestamp": "2024-12-08T15:30:45Z",
      "level": "INFO",
      "message": "Starting TriageIR scan..."
    },
    {
      "timestamp": "2024-12-08T15:30:46Z",
      "level": "INFO",
      "message": "Collecting system information..."
    },
    {
      "timestamp": "2024-12-08T15:30:47Z",
      "level": "INFO",
      "message": "Enumerating running processes..."
    },
    {
      "timestamp": "2024-12-08T15:30:48Z",
      "level": "INFO",
      "message": "Collecting network connections..."
    },
    {
      "timestamp": "2024-12-08T15:30:49Z",
      "level": "INFO",
      "message": "Analyzing persistence mechanisms..."
    },
    {
      "timestamp": "2024-12-08T15:30:50Z",
      "level": "WARNING",
      "message": "Suspicious persistence mechanism detected: SystemUpdate"
    },
    {
      "timestamp": "2024-12-08T15:30:51Z",
      "level": "INFO",
      "message": "Collecting event logs..."
    },
    {
      "timestamp": "2024-12-08T15:30:52Z",
      "level": "INFO",
      "message": "Scan completed successfully"
    }
  ]
}